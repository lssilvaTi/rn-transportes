---
import { CONTACT } from '../../utils/constants';
---

<header class="header-rn fixed top-0 left-0 right-0 z-50 bg-[var(--color-header-bg)]/95 backdrop-blur-sm border-b border-white/10 transition-shadow duration-300">
  <nav class="container mx-auto px-6 py-4 flex items-center justify-between">
    <a href="/" class="flex items-center hover:opacity-90 transition-opacity">
      <img src="/assets/logos/logo-rn-transportes.png" alt="RN Transportes e Mudanças" class="h-10 md:h-12 w-auto" width="180" height="48" />
    </a>
    <!-- Desktop Navigation -->
    <div class="hidden md:flex items-center gap-5 lg:gap-6">
      <a href="/" class="nav-link-rn text-white/90 hover:text-[var(--color-cyan)] transition-colors">Início</a>
      <a href="/sobre-nos" class="nav-link-rn text-white/90 hover:text-[var(--color-cyan)] transition-colors">Sobre Nós</a>
      <a href="/servicos" class="nav-link-rn text-white/90 hover:text-[var(--color-cyan)] transition-colors">Serviços</a>
      <a href="/contato" class="nav-link-rn text-white/90 hover:text-[var(--color-cyan)] transition-colors">Contato</a>
      <div class="flex items-center gap-1 border-l border-white/20 pl-4">
        <a href={CONTACT.facebook} target="_blank" rel="noopener noreferrer" class="header-social-link" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
        <a href={CONTACT.instagram} target="_blank" rel="noopener noreferrer" class="header-social-link" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
        <a href={`https://wa.me/${CONTACT.whatsapp}`} target="_blank" rel="noopener noreferrer" class="header-social-link" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
      </div>
      <a href="/orcamento" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium rounded-lg bg-white text-[var(--color-dark-blue)] hover:bg-white/90 transition-all">
        Solicitar orçamento
      </a>
      <button 
        id="theme-toggle" 
        class="p-2 rounded-lg text-white/70 hover:text-white hover:bg-white/10 transition-all"
        aria-label="Alternar tema"
        title="Alternar tema claro/escuro"
      >
        <i class="fas fa-moon text-lg" id="theme-icon"></i>
      </button>
    </div>
    
    <!-- Mobile -->
    <div class="md:hidden flex items-center gap-3">
      <button 
        id="theme-toggle-mobile" 
        class="p-2 rounded-lg text-white/70 hover:text-white hover:bg-white/10 transition-all"
        aria-label="Alternar tema"
        title="Alternar tema claro/escuro"
      >
        <i class="fas fa-moon text-lg" id="theme-icon-mobile"></i>
      </button>
      <button class="hamburger text-white" id="mobile-menu-button" aria-label="Abrir menu" aria-expanded="false">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu mobile-menu-rn" id="mobile-menu">
      <nav class="mobile-menu-nav">
        <a href="/" class="mobile-nav-link-rn">Início</a>
        <a href="/sobre-nos" class="mobile-nav-link-rn">Sobre Nós</a>
        <a href="/servicos" class="mobile-nav-link-rn">Serviços</a>
        <a href="/contato" class="mobile-nav-link-rn">Contato</a>
        <a href="/orcamento" class="mobile-nav-link-rn">Solicitar orçamento</a>
      </nav>
      <div class="mobile-menu-social">
        <a href={CONTACT.facebook} target="_blank" rel="noopener noreferrer" class="mobile-menu-social-link" aria-label="Facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href={CONTACT.instagram} target="_blank" rel="noopener noreferrer" class="mobile-menu-social-link" aria-label="Instagram">
          <i class="fab fa-instagram"></i>
        </a>
        <a href={`https://wa.me/${CONTACT.whatsapp}`} target="_blank" rel="noopener noreferrer" class="mobile-menu-social-link" aria-label="WhatsApp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </div>
    </div>
  </nav>
</header>

<style>
  .nav-link-rn {
    position: relative;
    text-decoration: none;
  }
  .nav-link-rn::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--color-cyan);
    transition: width 0.3s ease;
  }
  .nav-link-rn:hover::after {
    width: 100%;
  }

  .header-social-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    color: white;
    opacity: 0.9;
    transition: opacity 0.2s, color 0.2s, background 0.2s;
  }
  .header-social-link:hover {
    opacity: 1;
    color: var(--color-cyan);
  }
  .header-social-link i {
    font-size: 1rem;
  }

  .hamburger {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    width: 28px;
    height: 22px;
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0;
    z-index: 1001;
    gap: 5px;
  }
  .hamburger span {
    display: block;
    width: 100%;
    height: 3px;
    background: currentColor;
    border-radius: 2px;
    transition: all 0.3s ease;
    transform-origin: center;
  }
  .hamburger.active span:nth-child(1) {
    transform: rotate(45deg) translate(7px, 7px);
  }
  .hamburger.active span:nth-child(2) {
    opacity: 0;
    transform: translateX(-10px);
  }
  .hamburger.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
  }

  .mobile-menu-rn {
    position: fixed;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100vh;
    background: var(--color-header-bg);
    z-index: 1000;
    transition: left 0.3s ease;
    overflow-y: auto;
    padding-top: 80px;
  }
  .mobile-menu-rn.active {
    left: 0;
  }
  .mobile-menu-nav {
    display: flex;
    flex-direction: column;
    padding: 2rem 1.5rem;
    gap: 1.5rem;
  }
  .mobile-nav-link-rn {
    color: white;
    text-decoration: none;
    font-size: 1.25rem;
    font-weight: 500;
    padding: 0.75rem 0;
    border-bottom: 1px solid rgba(255,255,255,0.15);
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateX(-20px);
    animation: slideInFromLeft 0.3s ease forwards;
  }
  .mobile-menu-rn.active .mobile-nav-link-rn:nth-child(1) { animation-delay: 0.1s; }
  .mobile-menu-rn.active .mobile-nav-link-rn:nth-child(2) { animation-delay: 0.15s; }
  .mobile-menu-rn.active .mobile-nav-link-rn:nth-child(3) { animation-delay: 0.2s; }
  .mobile-menu-rn.active .mobile-nav-link-rn:nth-child(4) { animation-delay: 0.25s; }
  .mobile-menu-rn.active .mobile-nav-link-rn:nth-child(5) { animation-delay: 0.3s; }
  .mobile-nav-link-rn:hover {
    color: var(--color-cyan);
    padding-left: 1rem;
  }
  .mobile-menu-social {
    display: flex;
    gap: 1rem;
    justify-content: center;
    padding: 1.5rem 1.5rem 2rem;
    margin-top: 0.5rem;
    border-top: 1px solid rgba(255,255,255,0.15);
  }
  .mobile-menu-social-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: rgba(255,255,255,0.1);
    color: white;
    transition: background 0.2s, color 0.2s;
  }
  .mobile-menu-social-link:hover {
    background: var(--color-cyan);
    color: white;
  }
  .mobile-menu-social-link i {
    font-size: 1.25rem;
  }
  @keyframes slideInFromLeft {
    to { opacity: 1; transform: translateX(0); }
  }
  @media (min-width: 768px) {
    .mobile-menu-rn { display: none; }
  }
  .header-rn.scrolled {
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    border-bottom-color: rgba(255,255,255,0.15);
  }
</style>

<script>
  function updateIcon(theme: string) {
    const icon = document.getElementById('theme-icon');
    const iconMobile = document.getElementById('theme-icon-mobile');
    if (icon) icon.className = theme === 'light' ? 'fas fa-sun text-lg' : 'fas fa-moon text-lg';
    if (iconMobile) iconMobile.className = theme === 'light' ? 'fas fa-sun text-lg' : 'fas fa-moon text-lg';
  }
  function toggleTheme() {
    const current = document.documentElement.getAttribute('data-theme');
    const newTheme = current === 'light' ? 'dark' : 'light';
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    updateIcon(newTheme);
  }
  function initMobileMenu() {
    const hamburger = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    if (!hamburger || !mobileMenu) return;
    hamburger.addEventListener('click', () => {
      mobileMenu.classList.toggle('active');
      hamburger.classList.toggle('active');
      hamburger.setAttribute('aria-expanded', hamburger.classList.contains('active') ? 'true' : 'false');
      document.body.style.overflow = hamburger.classList.contains('active') ? 'hidden' : '';
    });
    mobileMenu.querySelectorAll('.mobile-nav-link-rn, .mobile-menu-social-link').forEach((link) => {
      link.addEventListener('click', () => {
        mobileMenu.classList.remove('active');
        hamburger.classList.remove('active');
        hamburger.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      });
    });
    document.addEventListener('click', (e) => {
      const target = e.target as Node | null;
      if (mobileMenu.classList.contains('active') && target && !mobileMenu.contains(target) && !hamburger.contains(target)) {
        mobileMenu.classList.remove('active');
        hamburger.classList.remove('active');
        hamburger.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      }
    });
  }
  function initSmoothScrolling() {
    document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
      anchor.addEventListener('click', (e) => {
        const href = anchor.getAttribute('href');
        if (!href || href === '#' || href === '#!') return;
        const target = document.querySelector(href);
        if (target) {
          e.preventDefault();
          const headerOffset = 80;
          const elementPosition = target.getBoundingClientRect().top;
          const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
          window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
        }
      });
    });
  }
  function initHeaderScrollEffect() {
    const header = document.querySelector('.header-rn');
    if (!header) return;
    window.addEventListener('scroll', () => {
      header.classList.toggle('scrolled', window.pageYOffset > 100);
    });
  }
  document.addEventListener('DOMContentLoaded', () => {
    const theme = document.documentElement.getAttribute('data-theme') || 'dark';
    updateIcon(theme);
    document.getElementById('theme-toggle')?.addEventListener('click', toggleTheme);
    document.getElementById('theme-toggle-mobile')?.addEventListener('click', toggleTheme);
    initMobileMenu();
    initSmoothScrolling();
    initHeaderScrollEffect();
  });
</script>
